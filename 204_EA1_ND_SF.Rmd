---
title: "EA1_ND_SF"
author: "Sandra Fogg & Natalie Dornan"
date: "4/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
## Load packages

library(tidyverse)
library(dplyr)
```

```{r}
#Create data frames containing the original data
og_df <- read_csv("HW1 Data.csv")
og_df


shark_df <- og_df %>% 
  select(pixel, cost_of_pixel, shark_suitability, tuna_suitability)

tuna_df <- og_df %>% 
  select(pixel, cost_of_pixel, tuna_suitability, shark_suitability)
```


```{r}

### PART B ###

#Arrange dataframes by cost to find the best suitability pixels by cost

shark_suit_df <- shark_df %>% 
  mutate("suit_per_unit_cost" = shark_suitability/cost_of_pixel) %>% 
  arrange(-suit_per_unit_cost) %>%
  mutate("cum_sum" = cumsum(cost_of_pixel)) %>%
  filter(cum_sum <200) %>%
  mutate("cba" = NULL)

shark_suit_df


##solve for alpha##

alpha_shark <- 1/(sum(og_df$shark_suitability)^0.6)

alpha_tuna <- 1/(sum(og_df$tuna_suitability)^0.6)
  
#find the probability of survival for both species even when sharks are sole concern

prob_shark <- alpha_shark*(sum(shark_suit_df$shark_suitability)^0.6)

prob_tuna <- alpha_tuna*(sum(shark_suit_df$tuna_suitability)^0.6)


```


```{r}

### PART C ###

##Tuna are sole concern

#Arrange dataframes by cost
tuna_suit_df <- tuna_df %>% 
  mutate("suit_per_unit_cost" = tuna_suitability/cost_of_pixel) %>% 
  arrange(-suit_per_unit_cost) %>%
  mutate("cum_sum" = cumsum(cost_of_pixel)) %>%
  filter(cum_sum <200)

tuna_suit_df

```


```{r}

### PART D ###
## Create 10 random reserve networks that you can afford within your budget. Show probability performance on a figure. 

##kyle created a for loop for the random number generator. new data frame, shark prob calc tuna prob calc
# 
# foo = seq(1, 100, by=2)
# 
# foo.squared = NULL
# 
# for (i in 1:50 ) {
# foo.squared[i] = foo[i]^2
# }

# tuna_suit_df <- tuna_df %>% 
#   mutate("suit_per_unit_cost" = tuna_suitability/cost_of_pixel) %>% 
#   arrange(-suit_per_unit_cost) %>%
#   mutate("cum_sum" = cumsum(cost_of_pixel)) %>%
#   filter(cum_sum <200)
# 
# tuna_suit_df

reserve.random = data.frame()
rando.probs = data.frame()

for (i in 1:10) {
  reserve.random = og_df[sample(1:nrow(og_df)),] %>%
       mutate("cum_sum" = cumsum(cost_of_pixel)) %>%
       filter(cum_sum <200) 
  
  rando.probs[i,1] = alpha_shark*(sum(reserve.random$shark_suitability)^0.6)
  rando.probs[i,2] = alpha_tuna*(sum(reserve.random$tuna_suitability)^0.6)

}

rando_probs_graph <- ggplot(rando.probs, aes(V1,V2)) +
  geom_point()

rando_probs_graph

```


```{r}

### PART E ###

##for loop i in whatever weights you want for a function you create for the probability calculation

survival_weight <- function(w) {
  
  shark_suit_df$cba <- (w*shark_suit_df$shark_suitability + (1-w)*shark_suit_df$tuna_suitability)/shark_suit_df$cost_of_pixel
  
  x <- shark_df %>%
    arrange(desc(cba)) %>%
    mutate(cum_sum = cum_sum(cost_of_pixel)) %>%
    filter(cum_sum <200)
  
  survival[1,1] <- alpha_shark*(sum(x$shark_suitability)^0.6)
  survival[1,2] <- alpha_tuna*(sum(x$tuna_suitability)^0.6)
  
  return(survival)
}

##for loop

w <- seq(0,1,0.1)

for (i in w) {
  x <- survival_weight(i)
}

solution <- lapply(w, survival_weight)


df <- data.frame()
for (i in 1:length(solution)) {
  df[i,1:2] <-solution[[i]]
}

```


```{r}


```


